<app-nav title="Order Draft"></app-nav>
<mat-tab-group mat-align-tabs="start" [selectedIndex]="selectedTab" (selectedIndexChange)="selectTab($event)" style="margin-top: 10px;">
  <mat-tab [label]="orderDraft.name">
    <div style="margin-top: 30px;padding-bottom: 10px;">
      <form>
        <div fxLayout="row" fxLayout="">
          <div fxFlex="40">
            <div fxLayout="column">
              <div>
                <mat-form-field>
                  <mat-label>Name</mat-label>
                  <input matInput placeholder="Some name" [(ngModel)]="orderDraft.name" name="name">
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <mat-label>Description</mat-label>
                  <textarea matInput placeholder="Some fancy description" [(ngModel)]="orderDraft.description" name="description"></textarea>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div fxFlex="55">
            <mat-card>
              <mat-card-header>
                <mat-card-title>Products</mat-card-title>
                <mat-card-subtitle>Add products to order</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div fxLayout="column" fxLayoutGap="5px" style="margin-left: 16px;">
                  <div *ngFor="let product of orderDraft.products; let i = index">
                    <div fxLayout="row">
                      <div fxFlex="30">
                        <div *ngIf="product.template">
                          <h3>{{ product.template.name }}</h3>
                        </div>
                        <div *ngIf="!product.template">
                          <button mat-raised-button (click)="selectProduct(i)">
                            Select
                          </button>
                        </div>
                      </div>
                      <div fxFlex="35">
                      </div>
                      <div fxFlex="15">
                        <mat-form-field style="width: 50px;">
                          <mat-label>Quantity</mat-label>
                          <input matInput [(ngModel)]="product.quantity" type="number" min="1" name="quantity">
                        </mat-form-field>
                      </div>
                      <div fxFlex="8">
                        <button mat-icon-button aria-label="Edit" *ngIf="product.template" (click)="editProduct(i)">
                          <mat-icon>edit</mat-icon>
                        </button>
                      </div>
                      <div fxFlex="8">
                        <button mat-icon-button aria-label="Remove" (click)="removeProduct(i)">
                          <mat-icon>delete</mat-icon>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-card-content>
              <mat-card-actions>
                <div fxLayout="row" fxLayoutAlign="center center" (click)="addProduct()" style="margin-bottom: 10px;">
                  <div>
                    <button mat-mini-fab color="primary">
                      <mat-icon>add</mat-icon>
                    </button>
                  </div>
                </div>
              </mat-card-actions>
            </mat-card>
          </div>
        </div>
      </form>
    </div>
  </mat-tab>
  <div *ngFor="let product of orderDraft.products">
    <mat-tab *ngIf="product.template" [label]="product.template.name">
      <app-product-template-tab *ngIf="product.template" [(productTemplate)]="product.template" [(selectedTab)]="subSelect"></app-product-template-tab>
    </mat-tab>
  </div>
</mat-tab-group>
