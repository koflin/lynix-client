<app-nav title="Process - {{ process.name }}"></app-nav>
<div fxLayout="column" fxLayoutAlign="space-between center" fxLayoutGap="20px" style="height: 80vh;width: 100%;">
  <div style="width: 100%;">
    <mat-tab-group [(selectedIndex)]="currentTabIndex">
      <mat-tab label="Overview">
        <div style="background-color:#f5f5f5;padding: 20px;">
          <mat-grid-list cols="4" gutterSize="10px" rowHeight="120px">
            <mat-grid-tile colspan="3" rowspan="1">
              <mat-card class="menu-group">
                <!--<mat-card-header>
                  <mat-card-title>General</mat-card-title>
                  <mat-card-subtitle>General process information</mat-card-subtitle>
                </mat-card-header>-->
                <mat-card-content>
                  <div fxLayout="row" style="margin-left: 15px;margin-right: 15px;">
                    <div>
                      <h4>Order Id: </h4>
                      <span>{{ process.orderId }}</span>
                    </div>
                    <div>
                      <h4>Process Id: </h4>
                      <span>{{ process.id }}</span>
                    </div>
                    <div>
                      <h4>Assignee: </h4>
                      <span>{{ process.assignedUserId }}</span>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="1" rowspan="1">
              <mat-card class="menu-group">
                <!--<mat-card-header>
                  <mat-card-title>General</mat-card-title>
                  <mat-card-subtitle>General process information</mat-card-subtitle>
                </mat-card-header>-->
                <mat-card-content>
                  <div fxLayout="row" style="margin-left: 15px;margin-right: 15px;">
                    <div>
                      <h4>Estimated Time: </h4>
                      <span>{{ getFullTime(process.estimatedTime) }}</span>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="3" rowspan="2">
              <mat-card class="menu-group">
                <mat-card-header>
                  <!--<mat-card-title>Main Tasks & Challenges</mat-card-title>-->
                  <!--<mat-card-subtitle>General process information</mat-card-subtitle>-->
                </mat-card-header>
                <mat-card-content>
                  <div fxLayout="column" fxLayoutGap="10px" style="margin-left: 15px;margin-right: 15px;">
                    <h4>Main Tasks & Challenges: </h4>
                    <div *ngFor="let task of process.mainTasks">
                      <mat-card style="background-color:#f5f5f5">{{ task }}</mat-card>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="1" rowspan="4">
              <mat-card class="menu-group">
                <mat-card-header>
                  <!--<mat-card-title>Overview</mat-card-title>-->
                  <!--<mat-card-subtitle>General process information</mat-card-subtitle>-->
                </mat-card-header>
                <mat-card-content>
                  <div fxLayout="column" style="margin-left: 15px;margin-right: 15px;">
                    <h4>Overview: </h4>
                    <div *ngFor="let step of process.steps; let i = index">
                      <span [class.selected-step]="process.currentStepIndex === i">| {{ step.title }}</span>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="3" rowspan="2">
              <mat-card class="menu-group">
                <mat-card-header>
                  <!--<mat-card-title>Previous commen</mat-card-title>-->
                  <!--<mat-card-subtitle>General process information</mat-card-subtitle>-->
                </mat-card-header>
                <mat-card-content>
                  <div fxLayout="column" style="margin-left: 15px;margin-right: 15px;">
                    <h4>Previous Comments: </h4>
                    <p *ngFor="let comment of process.previousComments">{{ comment }}</p>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
          </mat-grid-list>
        </div>
      </mat-tab>
      <div *ngFor="let step of process.steps; let i = index">
        <mat-tab [label]="step.title">
          <app-step-guide-tab [(step)]="process.steps[i]"></app-step-guide-tab>
        </mat-tab>
      </div>
      <mat-tab label="Finish">
        <div style="background-color:#f5f5f5;padding: 20px;">
          <mat-grid-list cols="4" gutterSize="10px" rowHeight="120px">
            <mat-grid-tile colspan="3" rowspan="1">
              <mat-card class="menu-group">
                <!--<mat-card-header>
                  <mat-card-title>General</mat-card-title>
                  <mat-card-subtitle>General process information</mat-card-subtitle>
                </mat-card-header>-->
                <mat-card-content>
                  <div fxLayout="row" style="margin-left: 15px;margin-right: 15px;">
                    <div>
                      <h4>Order Id: </h4>
                      <span>{{ process.orderId }}</span>
                    </div>
                    <div>
                      <h4>Process Id: </h4>
                      <span>{{ process.id }}</span>
                    </div>
                    <div>
                      <h4>Assignee: </h4>
                      <span>{{ process.assignedUserId }}</span>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="1" rowspan="1">
              <mat-card class="menu-group">
                <!--<mat-card-header>
                  <mat-card-title>General</mat-card-title>
                  <mat-card-subtitle>General process information</mat-card-subtitle>
                </mat-card-header>-->
                <mat-card-content>
                  <div fxLayout="column" style="margin-left: 15px;margin-right: 15px;">
                    <div style="margin-bottom: 5px;">
                      <h4>Estimated Time: </h4>
                      <span>{{ getFullTime(process.estimatedTime) }}</span>
                    </div>
                    <div>
                      <h4>Time Taken: </h4>
                      <span>{{ getFullTime(process.timeTaken) }}</span>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
            <mat-grid-tile colspan="4" rowspan="4">
              <mat-card class="menu-group">
                <!--<mat-card-header>
                  <mat-card-title>General</mat-card-title>
                  <mat-card-subtitle>General process information</mat-card-subtitle>
                </mat-card-header>-->
                <mat-card-content>
                  <table mat-table [dataSource]="dataSource" style="width: 100%; height: 100%;margin-top: 20px;">

                    <ng-container matColumnDef="stepNo">
                      <th mat-header-cell *matHeaderCellDef> Step Number </th>
                      <td mat-cell *matCellDef="let element"> {{ element.index }} </td>
                    </ng-container>

                    <ng-container matColumnDef="title">
                      <th mat-header-cell *matHeaderCellDef> Title </th>
                      <td mat-cell *matCellDef="let element"> {{element.step.title}} </td>
                    </ng-container>

                    <ng-container matColumnDef="timeTaken">
                      <th mat-header-cell *matHeaderCellDef> Time Taken </th>
                      <td mat-cell *matCellDef="let element"> {{ getFullTime(element.step.timeTaken) }} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
                </mat-card-content>
              </mat-card>
            </mat-grid-tile>
          </mat-grid-list>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
  <div style="width: 100%;">
    <mat-divider></mat-divider>
    <div fxLayout="row" fxLayoutGap="80px" style="padding-top: 10px;">
      <div style="text-align: center;">apx;" (click)="onExit()">
          <mat-icon style="transform: scale(3);">close</mat-icon>
        </button>
        <h5>Exit</h5>
      </div>
      <div style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" [disabled]="currentTabIndex === 0" (click)="onPrevious()">
          <mat-icon style="transform: scale(3);">skip_previous</mat-icon>
        </button>
        <h5>Previous</h5>
      </div>
      <div *ngIf="process.isRunning " style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" (click)="onStop()">
          <mat-icon style="transform: scale(2.5);">stop</mat-icon>
        </button>
        <h5>Pause</h5>
      </div>
      <div *ngIf="!process.isRunning && process.currentStepIndex !== undefined && currentTabIndex === process.currentStepIndex + 1" style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" (click)="onResume()">
          <mat-icon style="transform: scale(2.2);">play_arrow</mat-icon>
        </button>
        <h5>Resume</h5>
      </div>
      <div *ngIf="currentTabIndex !== 0 && currentTabIndex !== process.steps.length + 1 && (process.currentStepIndex === undefined || currentTabIndex !== process.currentStepIndex + 1)" style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" (click)="onSwitch()">
          <mat-icon style="transform: scale(2.2);">input</mat-icon>
        </button>
        <h5>Switch step</h5>
      </div>
      <div *ngIf="currentTabIndex === 0" style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" (click)="onJump()">
          <mat-icon style="transform: scale(2.2);">fast_forward</mat-icon>
        </button>
        <h5>Jump</h5>
      </div>
      <div *ngIf="currentTabIndex === process.steps.length + 1" style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" (click)="onFinish()">
          <mat-icon style="transform: scale(2.2);">check_circle_outline</mat-icon>
        </button>
        <h5>Finish</h5>
      </div>
      <div style="text-align: center;">
        <button mat-icon-button style="height: 60px;width: 60px;" [disabled]="currentTabIndex === process.steps.length + 1" (click)="onNext()">
          <mat-icon style="transform: scale(3);">skip_next</mat-icon>
        </button>
        <h5>Next</h5>
      </div>
      <div>
        <h2 *ngIf="process.steps[process.currentStepIndex] as currentStep">Current step: {{ currentStep.title }} - {{ getFullTime(currentStep.timeTaken) }}</h2>
        <h2>Total time: {{ getFullTime(process.timeTaken) }}</h2>
      </div>
    </div>
  </div>
</div>

